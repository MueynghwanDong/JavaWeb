<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>geolocation api</title>
<style>
input {
	width: 80px;
	margin-bottom: 10px;
}

tr:nth-child(2n) {
	background: rgba(0, 255, 0, 0.2);
}

tr:nth-child(2n+1) {
	background: rgba(0, 0, 255, 0.2);
}

.refresh {
	width: 450px;
}

td:nth-child(2n+1) {
	width: 150px;
}
</style>
</head>
<body>
	<label for="timeout">타임아웃(초)</label>
	<input type="number" min="0" id="timeout" value="2">
	<label for="maximumAge">최대유효기간(초)</label>
	<input type="number" min="0" id="maximumAge" value="0">
	<label for="enableHighAccuracy">높은 정확도</label>
	<input type="checkbox" id="enableHighAccuracy">
	<br>
	<button id="getLocation">현재 나의 위치</button>
	<button id="traceLocation">위치 추적하기</button>
	<button id="stopTrace">위치 추적 중지</button>
	<label for="cnt">추적 회수 : </label>
	<span id="cnt">0</span>
	<hr>
	<table>
		<tr>
			<th>속성</th>
			<th>값</th>
		</tr>
		<tr>
			<td>정보 획득 시각</td>
			<td>
				<input type="text" id="timestamp" class="refresh">
			</td>
		</tr>
		<tr>
			<td>위도(°)</td>
			<td>
				<input type="text" id="latitude" class="refresh">
			</td>
		</tr>
		<tr>
			<td>경도(°)</td>
			<td>
				<input type="text" id="longitude" class="refresh">
			</td>
		</tr>
		<tr>
			<td>오차(m)</td>
			<td>
				<input type="text" id="accuracy" class="refresh">
			</td>
		</tr>
		<tr>
			<td>에러메시지</td>
			<td>
				<input type="text" id="errorMessage" class="refresh">
			</td>
		</tr>
	</table>
	<div id="map" style="width: 500px; height: 400px;"></div>
</body>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=서비스키 등록"></script>
<script>
	var timeout = document.getElementById("timeout");
	var maximumAge = document.getElementById("maximumAge");
	var enableHighAccuracy = document.getElementById("enableHighAccuracy");
	var timestame = document.getElementById("timestamp");
	var latitude = document.getElementById("latitude");
	var longitude = document.getElementById("longitude");
	var accuracy = document.getElementById("accuracy");
	var errorMessage = document.getElementById("errorMessage");
	var tds = document.querySelectorAll(".refresh");
	var getLocationB = document.getElementById("getLocation");
	var traceLocationB = document.getElementById("traceLocation");
	var stopTraceB = document.getElementById("stopTrace");
	var cnt = document.getElementById("cnt");

	var geolocation = navigator.geolocation;

	getLocationB.addEventListener("click", function() {
		refreshFields();

		// TODO: 화면의 정보를 이용해서 options 객체를 생성 후 위치 정보를 표현하시오.
		// @@ 단 성공시에 success, 실패시에 error 함수를 호출한다.
		// END:
	});

	function refreshFields() {
		cnt.innerHTML = 0;
		for (var i = 0; i < tds.length; i++) {
			tds[i].value = "";
		}
	}

	function success(position) {
		var coords = position.coords;
		var date = new Date(position.timestamp);
		timestame.value = date.toLocaleString();
		latitude.value = coords.latitude;
		longitude.value = coords.longitude;
		accuracy.value = coords.accuracy;
		errorMessage.value = "";
		cnt.innerHTML = parseInt(cnt.innerHTML) + 1;
		// TODO: 카카오, 구글 등 다양한 지도 API를 이용해서 현재 위치를 지도로 화면에 표현하시오.
		// END:
		};

		var map = new daum.maps.Map(container, options); //지도 생성 및 객체 리턴
	}

	function error(positionError) {
		var msg;
		switch (positionError.code) {
		case 1:
			msg = "사용자가 권한 부여를 거부하였습니다.";
			break;
		case 2:
			msg = "내부 오류로 위치 정보를 가져오지 못하였습니다.";
			break;
		case 3:
			msg = "Timeout 초과로 정보를 가져오지 못하였습니다.";
		}
		errorMessage.value = msg;
	}
</script>

</html>
